SELECT
  srh.registered_entity_id,
  srh.effective_dt,
  srh.md5_src,
  srh.md5_tgt,

  -- new (incoming) values
  srh.public_registered_entity_id   AS new_pub_reg_ent_id,
  srh.public_issuer_bus_ent_id      AS new_pub_bus_ent_id,
  srh.public_issuer_bus_ent_type_cd AS new_pub_bus_ent_type_cd,
  srh.public_issuer_bus_ent_short_desc AS new_pub_bus_ent_short_desc,
  srh.public_issuer_bus_ent_long_desc  AS new_pub_bus_ent_long_desc,
  srh.public_issuer_bus_ent_fmr_id     AS new_pub_bus_ent_fmr_id,
  srh.public_issuer_cusip              AS new_pub_issuer_cusip,
  srh.public_equity_cusip              AS new_pub_equity_cusip,
  srh.public_equity_isin               AS new_pub_equity_isin,

  -- old (prod) values
  hist.public_registered_entity_id   AS old_pub_reg_ent_id,
  hist.public_issuer_bus_ent_id      AS old_pub_bus_ent_id,
  hist.public_issuer_bus_ent_type_cd AS old_pub_bus_ent_type_cd,
  hist.public_issuer_bus_ent_short_desc AS old_pub_bus_ent_short_desc,
  hist.public_issuer_bus_ent_long_desc  AS old_pub_bus_ent_long_desc,
  hist.public_issuer_bus_ent_fmr_id     AS old_pub_bus_ent_fmr_id,
  hist.public_issuer_cusip              AS old_pub_issuer_cusip,
  hist.public_equity_cusip              AS old_pub_equity_cusip,
  hist.public_equity_isin               AS old_pub_equity_isin

FROM PUBLIC_ATTR_TRNS_SRH_ALTID_QDATA_ALT AS srh
JOIN SECURITY_REFERENCE_HISTORY_BASE    AS hist
  ON srh.registered_entity_id = hist.registered_entity_id
 AND srh.effective_dt         = hist.effective_dt
WHERE srh.md5_src <> srh.md5_tgt
ORDER BY srh.registered_entity_id, srh.effective_dt;
